From b8d9aa910eb190fdb174a83c6db3c13b8aa032d6 Mon Sep 17 00:00:00 2001
From: Alexandru Costache <alexandru@balena.io>
Date: Wed, 5 May 2021 11:31:14 +0200
Subject: [PATCH] fsl-imx8mm-var-dart: Update pinmux for NRT board

Changes are according to "New OS ... 1 - v1.2.0.pdf"

Upstream-status: Inappropriate [configuration]
Signed-off-by: Alexandru Costache <alexandru@balena.io>
---
 .../dts/freescale/fsl-imx8mm-var-dart.dts     | 120 ++----------------
 1 file changed, 11 insertions(+), 109 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-imx8mm-var-dart.dts b/arch/arm64/boot/dts/freescale/fsl-imx8mm-var-dart.dts
index da228a0bbae2..316c63d434c5 100644
--- a/arch/arm64/boot/dts/freescale/fsl-imx8mm-var-dart.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-imx8mm-var-dart.dts
@@ -83,38 +83,6 @@
 		};
 	};
 
-	sound-spdif {
-		compatible = "fsl,imx-audio-spdif";
-		model = "imx-spdif";
-		spdif-controller = <&spdif1>;
-		spdif-out;
-		spdif-in;
-		status = "disabled";
-	};
-
-	sound-micfil {
-		compatible = "fsl,imx-audio-micfil";
-		model = "imx-audio-micfil";
-		cpu-dai = <&micfil>;
-		status = "disabled";
-	};
-
-	sound-wm8904 {
-		compatible = "fsl,imx-audio-wm8904";
-		model = "imx-wm8904";
-		audio-cpu = <&sai3>;
-		audio-codec = <&wm8904>;
-		audio-routing =
-			"Headphone Jack", "HPOUTL",
-			"Headphone Jack", "HPOUTR",
-			"IN2L", "Line In Jack",
-			"IN2R", "Line In Jack",
-			"IN1L", "Mic Jack",
-			"Playback", "CPU-Playback",
-			"CPU-Capture", "Capture";
-		status = "okay";
-	};
-
 	backlight: backlight {
 		compatible = "pwm-backlight";
 		pwms = <&pwm1 0 1000000 0>;
@@ -198,6 +166,16 @@
 				MX8MM_IOMUXC_SAI3_TXD_GPIO5_IO1                0x140
 				MX8MM_IOMUXC_SAI3_TXC_GPIO5_IO0                0x140
 				MX8MM_IOMUXC_SPDIF_RX_GPIO5_IO4                0x140
+				MX8MM_IOMUXC_SAI3_RXFS_GPIO4_IO28              0x140
+				MX8MM_IOMUXC_NAND_DATA00_GPIO3_IO6             0x140
+				MX8MM_IOMUXC_NAND_DATA02_GPIO3_IO8             0x140
+				MX8MM_IOMUXC_SAI5_MCLK_GPIO3_IO25              0x140
+				MX8MM_IOMUXC_SAI1_RXFS_GPIO4_IO0               0x140
+				MX8MM_IOMUXC_SAI1_RXC_GPIO4_IO1                0x140
+				MX8MM_IOMUXC_SAI2_RXFS_GPIO4_IO21              0x140
+				MX8MM_IOMUXC_SAI3_RXD_GPIO4_IO30               0x140
+				MX8MM_IOMUXC_UART3_TXD_GPIO5_IO27              0x140
+				MX8MM_IOMUXC_GPIO1_IO14_GPIO1_IO14             0x140
 			>;
 		};
 
@@ -230,9 +208,7 @@
 			fsl,pins = <
 				MX8MM_IOMUXC_NAND_ALE_QSPI_A_SCLK		0x1c2
 				MX8MM_IOMUXC_NAND_CE0_B_QSPI_A_SS0_B		0x82
-				MX8MM_IOMUXC_NAND_DATA00_QSPI_A_DATA0		0x82
 				MX8MM_IOMUXC_NAND_DATA01_QSPI_A_DATA1		0x82
-				MX8MM_IOMUXC_NAND_DATA02_QSPI_A_DATA2		0x82
 				MX8MM_IOMUXC_NAND_DATA03_QSPI_A_DATA3		0x82
 			>;
 		};
@@ -277,19 +253,8 @@
 			>;
 		};
 
-		pinctrl_sai3: sai3grp {
-			fsl,pins = <
-				MX8MM_IOMUXC_SAI3_RXFS_SAI3_RX_SYNC		0xd6
-				MX8MM_IOMUXC_SAI3_RXC_SAI3_RX_BCLK		0xd6
-				MX8MM_IOMUXC_SAI3_RXD_SAI3_RX_DATA0		0xd6
-				MX8MM_IOMUXC_SAI3_TXFS_SAI3_TX_SYNC		0xd6
-				MX8MM_IOMUXC_SAI3_MCLK_SAI3_MCLK		0xd6
-			>;
-		};
-
 		pinctrl_pdm: pdmgrp {
 			fsl,pins = <
-				MX8MM_IOMUXC_SAI5_MCLK_SAI5_MCLK		0xd6
 				MX8MM_IOMUXC_SAI5_RXC_PDM_CLK			0xd6
 				MX8MM_IOMUXC_SAI5_RXFS_SAI5_RX_SYNC		0xd6
 				MX8MM_IOMUXC_SAI5_RXD0_PDM_DATA0		0xd6
@@ -319,13 +284,6 @@
 			>;
 		};
 
-		pinctrl_uart3: uart3grp {
-			fsl,pins = <
-				MX8MM_IOMUXC_UART3_RXD_UART3_DCE_RX		0x140
-				MX8MM_IOMUXC_UART3_TXD_UART3_DCE_TX		0x140
-			>;
-		};
-
 		pinctrl_uart4: uart4grp {
 			fsl,pins = <
 				MX8MM_IOMUXC_ECSPI2_SCLK_UART4_DCE_RX		0x140
@@ -499,13 +457,6 @@
 			>;
 		};
 
-		pinctrl_captouch: captouchgrp {
-			fsl,pins = <
-				MX8MM_IOMUXC_SAI1_RXD3_GPIO4_IO5		0x16
-				MX8MM_IOMUXC_GPIO1_IO14_GPIO1_IO14		0x16
-			>;
-		};
-
 		pinctrl_ecspi1: ecspi1grp {
 			fsl,pins = <
 				MX8MM_IOMUXC_ECSPI1_SCLK_ECSPI1_SCLK		0x13
@@ -728,22 +679,6 @@
 	pinctrl-0 = <&pinctrl_i2c2>;
 	status = "okay";
 
-	/* Capacitive touch controller */
-	ft5x06_ts: ft5x06_ts@38 {
-		status = "okay";
-		compatible = "edt,edt-ft5x06";
-		reg = <0x38>;
-		reset-gpios = <&gpio4 5 GPIO_ACTIVE_LOW>;
-		pinctrl-names = "default";
-		pinctrl-0 = <&pinctrl_captouch>;
-		interrupt-parent = <&gpio1>;
-		interrupts = <14 0>;
-		touchscreen-size-x = <800>;
-		touchscreen-size-y = <480>;
-		touchscreen-inverted-x;
-		touchscreen-inverted-y;
-	};
-
 	ov5640_mipi1: ov5640_mipi1@3c {
 		status = "okay";
 		compatible = "ovti,ov5640_mipi";
@@ -789,25 +724,6 @@
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_i2c3>;
 	status = "okay";
-
-	wm8904: codec@1a {
-		compatible = "wlf,wm8904";
-		reg = <0x1a>;
-		clocks = <&clk IMX8MM_CLK_SAI3_ROOT>;
-		clock-names = "mclk";
-		DCVDD-supply = <&ldo5_reg>;
-		DBVDD-supply = <&reg_audio>;
-		AVDD-supply = <&ldo5_reg>;
-		CPVDD-supply = <&ldo5_reg>;
-		MICVDD-supply = <&ldo5_reg>;
-		status = "okay";
-		gpio-cfg = <
-			0x0018 /* GPIO1 => DMIC_CLK */
-			0xffff /* GPIO2 => don't touch */
-			0xffff /* GPIO3 => don't touch */
-			0xffff /* GPIO4 => don't touch */
-		>;
-	};
 };
 
 &i2c4 {
@@ -850,15 +766,6 @@
 	status = "okay";
 };
 
-&sai3 {
-	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_sai3>;
-	assigned-clocks = <&clk IMX8MM_CLK_SAI3>;
-	assigned-clock-parents = <&clk IMX8MM_AUDIO_PLL1_OUT>;
-	assigned-clock-rates = <1536000>;
-	status = "okay";
-};
-
 &spdif1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_spdif1>;
@@ -923,12 +830,7 @@
 	status = "okay";
 };
 
-/* Header */
-&uart3 {
-	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_uart3>;
-	status = "okay";
-};
+/* uart3 TXD used by gpio5 27
 
 /* BT */
 &uart4 {
-- 
2.17.1

